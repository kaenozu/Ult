# [SEC-004] シークレット管理の強化

## 概要

APIキー等のシークレットが環境変数に依存しており、ローテーション機能がありません。セキュリティを強化し、シークレットの一元管理と自動ローテーションを実現します。

## 対応内容

1. **GitHub Secretsの整理・監査**
   - 現在のSecrets一覧の作成と分類
   - 不使用Secretsの特定と削除
   - アクセス権限の見直し

2. **シークレット管理サービスの検討・導入**
   - AWS Secrets Manager検討
   - HashiCorp Vault検討
   - 要件に応じた選定と導入

3. **シークレットローテーション自動化**
   - ローテーションポリシーの定義
   - 自動ローテーションスクリプトの作成
   - ローテーション履歴の管理

## 受け入れ条件（Acceptance Criteria）

- [ ] 現在のGitHub Secretsが監査され、不使用のものが削除されている
- [ ] シークレット管理サービス（AWS Secrets ManagerまたはVault）が導入されている
- [ ] 全ての本番シークレットが管理サービスに移行されている
- [ ] シークレットローテーションが自動化され、90日ごとに実行される
- [ ] ローテーション履歴がログとして記録・監査可能である
- [ ] シークレットへのアクセスログが記録され、異常検知が可能である

## 関連するレビュー発見事項

- APIキー等のシークレットが環境変数に依存している
- シークレットローテーション機能がない
- シークレットへのアクセス権限管理が不十分

## 想定工数

20時間

## 優先度

Medium

## 担当ロール

DevOps Engineer + Backend Engineer

## ラベル

`security`, `priority:medium`, `infrastructure`, `secrets`

---

## 補足情報

### シークレット分類案

| カテゴリ | 例 | ローテーション頻度 |
|----------|-----|-------------------|
| データベース認証情報 | DB接続文字列 | 90日 |
| APIキー | 外部サービスAPIキー | 180日 |
| 証明書 | SSL/TLS証明書 | 1年 |
| 暗号化キー | データ暗号化キー | 1年 |
| アクセストークン | OAuthトークン | 90日 |

### 推奨アーキテクチャ

```
┌─────────────────┐
│   Application   │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│  Secrets Manager │
│ (AWS/Vault)     │
└────────┬────────┘
         │
    ┌────┴────┐
    ▼         ▼
┌───────┐  ┌────────┐
│ Audit │  │Rotation│
│ Logs  │  │Engine  │
└───────┘  └────────┘
```
