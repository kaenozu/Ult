# Security Audit Skill

Webアプリケーションの脆弱性を特定し、セキュアなコーディングを徹底するためのスキルです。VibeSec-Skillの指針に基づき、ハッキングのリスクを最小化します。

## 🎯 重点項目
- **Input Validation**: ユーザー入力のサニタイズとバリデーション。
- **Authentication/Authorization**: 認証と認可の適切な実装。
- **Safe Dependencies**: 脆弱性のあるライブラリの排除。
- **Secrets Management**: APIキーや資格情報の漏洩防止。
- **Error Handling**: 内部情報が漏れるような詳細なエラーメッセージの禁止。

## 📋 監査チェックリスト

### 1. 入力バリデーション
- フォーム入力やURLパラメータに対して、PydanticやZodによる厳格な型チェックが行われているか。
- SQLインジェクション攻撃を防ぐためのパラメーター化クエリの使用。

### 2. セルフ・プロテクション
- フロントエンドでのクロスサイトスクリプティング（XSS）対策。
- クロスサイトリクエストフォージェリ（CSRF）対策。

### 3. シークレットの管理
- `.env` ファイルに機密情報が記述され、`.gitignore` に含まれているか。
- コード内にAPIキーがハードコードされていないか。

### 4. 依存関係の健全性
- `npm audit` や `pip audit` による定期的なチェック。
- セキュリティパッチが適用された最新バージョンへの更新。

## 🛠 推奨アクション
- **FastAPI**: `TypedWebSocketManager` のように、全メッセージに型を強制する。
- **Next.js**: `Server Actions` 使用時の認可チェックを徹底する。
- **Database**: 最小権限の原則に基づくDBユーザーの作成。

## 🛡 レポートフォーマット

```markdown
# 🛡 セキュリティ監査レポート

## 🔍 スキャン結果
- **脆弱性スコア**: [高 / 中 / 低]
- **指摘事項**:
  - [項目1]: [詳細とリスク]

## 🛠 対策案
1. [コード修正案1]
2. [構成変更案2]

## ✅ ステータス
- [ ] 未対策 / [ ] 修正中 / [x] 修正完了
```
