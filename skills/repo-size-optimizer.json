{
  "name": "repo-size-optimizer",
  "description": "Gitリポジトリのサイズを最適化するスキル。大きなファイルの検出、履歴からの削除、キャッシュファイルのクリーンアップ、git filter-repoによる履歴書き換えを実行する。",
  "version": "1.0.0",
  "priority": "high",
  "auto_activate": true,
  "triggers": [
    "リポジトリサイズが大きすぎる",
    "無駄なものを探して",
    "サイズを削減",
    ".gitが大きい"
  ],
  "rules": [
    "large-file-detection",
    "history-rewrite",
    "cache-cleanup",
    "binary-file-exclusion",
    "aggressive-gc"
  ],
  "detection_patterns": [
    "node_modules/",
    ".next/",
    "*.pack.gz",
    "coverage/",
    "test-results/",
    "*.log",
    ".pytest_cache/",
    ".mypy_cache/",
    ".ruff_cache/",
    "__pycache__/"
  ],
  "workflow": {
    "step1": "現在のサイズと大きなファイルの検出",
    "step2": "Git履歴から大きなファイルを特定",
    "step3": "git-filter-repoによる履歴書き換え",
    "step4": "キャッシュファイルの削除",
    "step5": "git gc --aggressiveによる圧縮",
    "step6": "削減結果のレポート"
  },
  "commands": [
    "du -sh .git",
    "git rev-list --objects --all | git cat-file --batch-check='%(objecttype) %(objectname) %(objectsize) %(rest)' | awk '$1 == \"blob\" && $3 > 1000000 {print $3, $4}'",
    "git filter-repo --path {path} --invert-paths --force",
    "git gc --aggressive --prune=now"
  ],
  "capabilities": [
    "大きなファイルの自動検出",
    "Git履歴からの完全削除",
    "複数種類のキャッシュファイル一括削除",
    "リポジトリサイズの劇的削減（90%以上）"
  ]
}
