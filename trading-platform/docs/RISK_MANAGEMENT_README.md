# Enhanced Risk Management System

> **TRADING-003**: ãƒªã‚¹ã‚¯ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ã®é«˜åº¦åŒ–

é«˜åº¦ãªæ©Ÿæ¢°å­¦ç¿’ãƒ™ãƒ¼ã‚¹ã®ãƒˆãƒ¬ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã®ãŸã‚ã®åŒ…æ‹¬çš„ãªãƒªã‚¹ã‚¯ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ã€‚

## ğŸ¯ æ¦‚è¦

ã“ã®ã‚·ã‚¹ãƒ†ãƒ ã¯ã€ãƒˆãƒ¬ãƒ¼ãƒ€ãƒ¼ã¨ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ãŒå®‰å…¨ã‹ã¤åŠ¹æœçš„ã«å–å¼•ã§ãã‚‹ã‚ˆã†ã€4ã¤ã®ä¸»è¦ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’æä¾›ã—ã¾ã™ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          Enhanced Risk Management System                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚ Dynamic Position â”‚  â”‚  Correlation     â”‚             â”‚
â”‚  â”‚     Sizing       â”‚  â”‚   Manager        â”‚             â”‚
â”‚  â”‚                  â”‚  â”‚                  â”‚             â”‚
â”‚  â”‚ â€¢ Volatility     â”‚  â”‚ â€¢ Correlation    â”‚             â”‚
â”‚  â”‚ â€¢ Correlation    â”‚  â”‚ â€¢ Concentration  â”‚             â”‚
â”‚  â”‚ â€¢ Kelly          â”‚  â”‚ â€¢ Hedge Recs     â”‚             â”‚
â”‚  â”‚ â€¢ Risk Parity    â”‚  â”‚                  â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚  Stress Test    â”‚  â”‚   Psychology     â”‚             â”‚
â”‚  â”‚    Engine       â”‚  â”‚    Monitor       â”‚             â”‚
â”‚  â”‚                  â”‚  â”‚                  â”‚             â”‚
â”‚  â”‚ â€¢ Scenarios     â”‚  â”‚ â€¢ Behavior       â”‚             â”‚
â”‚  â”‚ â€¢ Monte Carlo   â”‚  â”‚ â€¢ Alerts         â”‚             â”‚
â”‚  â”‚ â€¢ Worst Case    â”‚  â”‚ â€¢ Rules          â”‚             â”‚
â”‚  â”‚                  â”‚  â”‚                  â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“¦ ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

ã‚·ã‚¹ãƒ†ãƒ ã¯æ—¢ã«ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«çµ±åˆã•ã‚Œã¦ã„ã¾ã™ï¼š

```typescript
import {
  DynamicPositionSizing,
  CorrelationManager,
  StressTestEngine,
  PsychologyMonitor,
} from '@/app/lib/risk';
```

## ğŸš€ ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ

### 1åˆ†ã§å§‹ã‚ã‚‹

```typescript
import { createDynamicPositionSizing } from '@/app/lib/risk';

// 1. è¨­å®š
const config = {
  maxPositionSize: 100000,
  maxPositionPercent: 10,
  riskPerTrade: 2,
  maxRisk: 5000,
  volatilityAdjustment: true,
  correlationAdjustment: true,
};

// 2. ä½œæˆ
const sizing = createDynamicPositionSizing(config, portfolio);

// 3. è¨ˆç®—
const result = sizing.calculatePositionSize(
  'AAPL',        // ã‚·ãƒ³ãƒœãƒ«
  150,           // ã‚¨ãƒ³ãƒˆãƒªãƒ¼ä¾¡æ ¼
  145,           // ã‚¹ãƒˆãƒƒãƒ—ãƒ­ã‚¹
  marketData,    // ãƒãƒ¼ã‚±ãƒƒãƒˆãƒ‡ãƒ¼ã‚¿
  75             // ä¿¡é ¼åº¦
);

// 4. ä½¿ç”¨
console.log(`æ¨å¥¨: ${result.recommendedSize} æ ª`);
console.log(`ãƒªã‚¹ã‚¯: $${result.riskAmount}`);
```

## ğŸ”‘ ä¸»è¦æ©Ÿèƒ½

### 1. DynamicPositionSizing

**å‹•çš„ãƒã‚¸ã‚·ãƒ§ãƒ³ã‚µã‚¤ã‚¸ãƒ³ã‚°** - å¸‚å ´çŠ¶æ³ã«å¿œã˜ãŸæœ€é©ãªãƒã‚¸ã‚·ãƒ§ãƒ³ã‚µã‚¤ã‚ºã‚’è‡ªå‹•è¨ˆç®—

```typescript
// ãƒœãƒ©ãƒ†ã‚£ãƒªãƒ†ã‚£èª¿æ•´
positionSizing.updateVolatility('AAPL', 0.03);

// KellyåŸºæº–
const kelly = positionSizing.calculateKellyCriterion(
  0.6,    // å‹ç‡ 60%
  0.02,   // å¹³å‡å‹ã¡ 2%
  0.01,   // å¹³å‡è² ã‘ 1%
  150
);

// ãƒªã‚¹ã‚¯ãƒ‘ãƒªãƒ†ã‚£
const riskParity = positionSizing.calculateRiskParitySizing(
  'AAPL',
  150,
  0.02
);
```

**ç‰¹å¾´:**
- âœ… ãƒœãƒ©ãƒ†ã‚£ãƒªãƒ†ã‚£ãƒ™ãƒ¼ã‚¹ã®è‡ªå‹•èª¿æ•´
- âœ… ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªç›¸é–¢ã‚’è€ƒæ…®
- âœ… KellyåŸºæº–ã«ã‚ˆã‚‹æœ€é©åŒ–
- âœ… ãƒªã‚¹ã‚¯ãƒ‘ãƒªãƒ†ã‚£ã‚¢ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³
- âœ… ä¿¡é ¼åº¦ãƒ™ãƒ¼ã‚¹ã®ã‚µã‚¤ã‚ºèª¿æ•´

### 2. CorrelationManager

**ç›¸é–¢ç®¡ç†** - ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªã®å¤šæ§˜åŒ–ã¨ãƒ˜ãƒƒã‚¸æˆ¦ç•¥

```typescript
const correlationMgr = createCorrelationManager();

// ç›¸é–¢åˆ†æ
correlationMgr.updatePriceHistory('AAPL', priceHistory);
const correlation = correlationMgr.calculatePairwiseCorrelation('AAPL', 'MSFT');

// é›†ä¸­ãƒªã‚¹ã‚¯æ¤œå‡º
const risks = correlationMgr.detectConcentrationRisk(portfolio, 0.25);

// ãƒ˜ãƒƒã‚¸æ¨å¥¨
const hedges = correlationMgr.generateHedgeRecommendations(
  portfolio,
  ['GLD', 'TLT', 'VXX']
);
```

**ç‰¹å¾´:**
- âœ… Pearsonç›¸é–¢ä¿‚æ•°ã®è¨ˆç®—
- âœ… ç›¸é–¢è¡Œåˆ—ã®è‡ªå‹•ç”Ÿæˆ
- âœ… é›†ä¸­ãƒªã‚¹ã‚¯ã®è‡ªå‹•æ¤œå‡º
- âœ… è² ç›¸é–¢è³‡ç”£ã®ç™ºè¦‹
- âœ… æœ€é©ãƒ˜ãƒƒã‚¸æ¯”ç‡ã®è¨ˆç®—

### 3. StressTestEngine

**ã‚¹ãƒˆãƒ¬ã‚¹ãƒ†ã‚¹ãƒˆ** - æ¥µç«¯ãªå¸‚å ´ã‚·ãƒŠãƒªã‚ªã¸ã®å‚™ãˆ

```typescript
const stressTest = createStressTestEngine(portfolio);

// ã‚·ãƒŠãƒªã‚ªãƒ†ã‚¹ãƒˆ
const results = stressTest.runMultipleScenarios();

// Monte Carlo
const mcResult = stressTest.runMonteCarloSimulation({
  numSimulations: 1000,
  timeHorizon: 30,
  confidenceLevel: 0.95
});

// æœ€æ‚ªã‚±ãƒ¼ã‚¹
const worstCase = stressTest.analyzeWorstCase();
```

**ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚·ãƒŠãƒªã‚ª:**
| ã‚·ãƒŠãƒªã‚ª | ä¸‹è½å¹… | ãƒœãƒ©ãƒ†ã‚£ãƒªãƒ†ã‚£ |
|---------|--------|---------------|
| Market Crash | -20% | 3.0x |
| Flash Crash | -10% | 5.0x |
| Moderate Correction | -10% | 1.5x |
| Volatility Spike | -5% | 4.0x |
| Black Swan | -30% | 10.0x |

**ç‰¹å¾´:**
- âœ… 5ã¤ã®äº‹å‰å®šç¾©ã‚·ãƒŠãƒªã‚ª
- âœ… ã‚«ã‚¹ã‚¿ãƒ ã‚·ãƒŠãƒªã‚ªã®ã‚µãƒãƒ¼ãƒˆ
- âœ… Monte Carloã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
- âœ… VaR/CVaRè¨ˆç®—
- âœ… æœ€æ‚ªã‚±ãƒ¼ã‚¹åˆ†æ

### 4. PsychologyMonitor

**å¿ƒç†ç›£è¦–** - æ„Ÿæƒ…çš„ãªå–å¼•ã‚’é˜²ãã€è¦å¾‹ã‚’ç¶­æŒ

```typescript
const psychMonitor = createPsychologyMonitor();

// ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†
psychMonitor.startSession();
psychMonitor.recordTrade(order);

// è¡Œå‹•åˆ†æ
const metrics = psychMonitor.analyzeTradingBehavior();
console.log(`å‹ç‡: ${metrics.winRate * 100}%`);
console.log(`ã‚ªãƒ¼ãƒãƒ¼ãƒˆãƒ¬ãƒ¼ãƒ‰: ${metrics.overTradingScore}`);

// ã‚¢ãƒ©ãƒ¼ãƒˆ
const alerts = psychMonitor.generatePsychologyAlerts();
alerts.forEach(alert => {
  console.log(`${alert.type}: ${alert.message}`);
});

// ãƒªã‚¹ã‚¯ãƒã‚§ãƒƒã‚¯
const riskCheck = psychMonitor.checkExcessiveRiskTaking(
  proposedPosition,
  normalRisk
);
```

**ã‚¢ãƒ©ãƒ¼ãƒˆã‚¿ã‚¤ãƒ—:**
- ğŸš¨ **Overtrading** - éåº¦ãªå–å¼•ï¼ˆã‚¹ã‚³ã‚¢70+ï¼‰
- ğŸ˜¡ **Revenge Trading** - å ±å¾©å–å¼•ï¼ˆé€£ç¶šæå¤±3+ï¼‰
- ğŸ˜° **Fear** - ææ€–ã«ã‚ˆã‚‹å–å¼•
- ğŸ¤‘ **Greed** - æ¬²ã«ã‚ˆã‚‹å–å¼•
- ğŸ˜´ **Fatigue** - ç–²åŠ´ï¼ˆ4æ™‚é–“ä»¥ä¸Šï¼‰

**ç‰¹å¾´:**
- âœ… ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ è¡Œå‹•åˆ†æ
- âœ… 4ç¨®é¡ã®å¿ƒç†ã‚¢ãƒ©ãƒ¼ãƒˆ
- âœ… ã‚ªãƒ¼ãƒãƒ¼ãƒˆãƒ¬ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°æ¤œå‡º
- âœ… ãƒ«ãƒ¼ãƒ«é•åãƒã‚§ãƒƒã‚¯
- âœ… ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†

## ğŸ“Š çµ±è¨ˆ

| ãƒ¡ãƒˆãƒªã‚¯ã‚¹ | å€¤ |
|----------|-----|
| **ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆæ•°** | 4 |
| **ç·ã‚³ãƒ¼ãƒ‰è¡Œæ•°** | 1,529 |
| **ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹æ•°** | 232 |
| **å‹å®šç¾©æ•°** | 18 |
| **ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãƒšãƒ¼ã‚¸** | 550+ è¡Œ |

## ğŸ§ª ãƒ†ã‚¹ãƒˆ

```bash
# ã™ã¹ã¦ã®ãƒªã‚¹ã‚¯ç®¡ç†ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œ
npm test -- app/lib/risk/__tests__/

# å€‹åˆ¥ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
npm test -- DynamicPositionSizing.test.ts
npm test -- CorrelationManager.test.ts
npm test -- StressTestEngine.test.ts
npm test -- PsychologyMonitor.test.ts
```

### ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸

```
âœ… DynamicPositionSizing    49 tests
âœ… CorrelationManager       56 tests
âœ… StressTestEngine         67 tests
âœ… PsychologyMonitor        60 tests
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
âœ… Total                   232 tests
```

## ğŸ“– ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- ğŸ“˜ **[çµ±åˆã‚¬ã‚¤ãƒ‰](./docs/RISK_MANAGEMENT_INTEGRATION.md)** - å®Œå…¨ãªä½¿ç”¨ä¾‹ã¨ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹
- ğŸ“— **å‹å®šç¾©** - `app/types/risk.ts`
- ğŸ“™ **ãƒ†ã‚¹ãƒˆ** - `app/lib/risk/__tests__/`

## ğŸ“ ä½¿ç”¨ä¾‹

### ä¾‹1: å®Œå…¨ãªå–å¼•ãƒ•ãƒ­ãƒ¼

```typescript
// 1. åˆæœŸåŒ–
const sizing = createDynamicPositionSizing(config, portfolio);
const correlation = createCorrelationManager();
const stress = createStressTestEngine(portfolio);
const psych = createPsychologyMonitor();

// 2. ãƒ‡ãƒ¼ã‚¿æ›´æ–°
correlation.updatePriceHistory('AAPL', prices);
sizing.updateVolatility('AAPL', 0.03);
stress.updateHistoricalData('AAPL', returns);

// 3. ãƒªã‚¹ã‚¯åˆ†æ
const concentrationRisks = correlation.detectConcentrationRisk(portfolio);
const stressResults = stress.runMultipleScenarios();
const behavior = psych.analyzeTradingBehavior();

// 4. å–å¼•æ±ºå®š
if (concentrationRisks.length === 0 && behavior.emotionalTradingScore < 70) {
  const sizing = sizing.calculatePositionSize('AAPL', 150, 145, data, 75);
  
  // ãƒªã‚¹ã‚¯ãƒã‚§ãƒƒã‚¯
  const check = psych.checkExcessiveRiskTaking(
    { size: sizing.recommendedSize, riskAmount: sizing.riskAmount },
    normalRisk
  );
  
  if (!check.isExcessive) {
    // âœ… å–å¼•å®Ÿè¡Œ
    executeOrder(sizing);
    psych.recordTrade(order);
  }
}
```

### ä¾‹2: ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªç›£è¦–

```typescript
// å®šæœŸçš„ãªãƒªã‚¹ã‚¯ç›£è¦–
setInterval(async () => {
  // ç›¸é–¢ãƒã‚§ãƒƒã‚¯
  const correlations = correlation.calculateCorrelationMatrix(symbols);
  
  // ã‚¹ãƒˆãƒ¬ã‚¹ãƒ†ã‚¹ãƒˆ
  const stressResults = stress.runMultipleScenarios();
  
  // å¿ƒç†ãƒã‚§ãƒƒã‚¯
  const alerts = psych.generatePsychologyAlerts();
  
  // é«˜ãƒªã‚¹ã‚¯ã®å ´åˆã¯é€šçŸ¥
  if (alerts.some(a => a.severity === 'high')) {
    notifyRiskManager(alerts);
  }
  
  if (stressResults.some(r => r.portfolioImpactPercent < -15)) {
    notifyRiskManager(stressResults);
  }
}, 3600000); // 1æ™‚é–“ã”ã¨
```

### ä¾‹3: ãƒ˜ãƒƒã‚¸æˆ¦ç•¥

```typescript
// é›†ä¸­ãƒªã‚¹ã‚¯ã‚’æ¤œå‡ºã—ã¦ãƒ˜ãƒƒã‚¸
const risks = correlation.detectConcentrationRisk(portfolio, 0.20);

if (risks.length > 0) {
  console.log('âš ï¸ é›†ä¸­ãƒªã‚¹ã‚¯æ¤œå‡º:');
  risks.forEach(risk => {
    console.log(`  ${risk.symbol}: ${(risk.weight * 100).toFixed(1)}%`);
  });
  
  // ãƒ˜ãƒƒã‚¸æ¨å¥¨ã‚’å–å¾—
  const hedges = correlation.generateHedgeRecommendations(
    portfolio,
    ['GLD', 'TLT', 'VXX', 'SHY']
  );
  
  console.log('\nğŸ’¡ ãƒ˜ãƒƒã‚¸æ¨å¥¨:');
  hedges.forEach(hedge => {
    console.log(`  ${hedge.primarySymbol} â†’ ${hedge.hedgeSymbol}`);
    console.log(`  æ¯”ç‡: ${(hedge.hedgeRatio * 100).toFixed(1)}%`);
    console.log(`  ç†ç”±: ${hedge.reasoning}`);
  });
}
```

## âš¡ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹

| æ“ä½œ | æ™‚é–“è¤‡é›‘åº¦ | å‚™è€ƒ |
|-----|-----------|------|
| ãƒã‚¸ã‚·ãƒ§ãƒ³ã‚µã‚¤ã‚ºè¨ˆç®— | O(1) | å³åº§ |
| ç›¸é–¢è¨ˆç®— | O(nÂ²) | ã‚­ãƒ£ãƒƒã‚·ãƒ³ã‚°æ¸ˆã¿ |
| ã‚¹ãƒˆãƒ¬ã‚¹ãƒ†ã‚¹ãƒˆ | O(n) | ãƒã‚¸ã‚·ãƒ§ãƒ³æ•°ã«æ¯”ä¾‹ |
| Monte Carlo | O(mÃ—n) | m=ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æ•° |
| å¿ƒç†åˆ†æ | O(n) | å–å¼•æ•°ã«æ¯”ä¾‹ |

### æœ€é©åŒ–ã®ãƒ’ãƒ³ãƒˆ

```typescript
// âœ… è‰¯ã„ - ãƒãƒƒãƒæ›´æ–°
const symbols = ['AAPL', 'MSFT', 'GOOGL'];
symbols.forEach(s => correlation.updatePriceHistory(s, prices[s]));

// âŒ æ‚ªã„ - æ¯å›ç›¸é–¢ã‚’å†è¨ˆç®—
symbols.forEach(s1 => {
  symbols.forEach(s2 => {
    correlation.calculatePairwiseCorrelation(s1, s2); // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã•ã‚Œã‚‹ãŒç„¡é§„
  });
});

// âœ… è‰¯ã„ - ä¸€åº¦ã ã‘è¨ˆç®—
const matrix = correlation.calculateCorrelationMatrix(symbols);
```

## ğŸ”’ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£

### å…¥åŠ›æ¤œè¨¼

ã™ã¹ã¦ã®å…¥åŠ›ã¯æ¤œè¨¼ã•ã‚Œã¾ã™ï¼š

```typescript
// è‡ªå‹•çš„ã«ãƒã‚§ãƒƒã‚¯
- ä¾¡æ ¼ > 0
- ãƒœãƒ©ãƒ†ã‚£ãƒªãƒ†ã‚£ >= 0
- ä¿¡é ¼åº¦ 0-100
- ãƒªã‚¹ã‚¯é¡ > 0
```

### ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

```typescript
try {
  const result = sizing.calculatePositionSize(...);
} catch (error) {
  if (error.message.includes('Invalid')) {
    // å…¥åŠ›ã‚¨ãƒ©ãƒ¼
  } else {
    // ãã®ä»–ã®ã‚¨ãƒ©ãƒ¼
  }
}
```

## ğŸ› ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### Q: ç›¸é–¢ãŒå¸¸ã«0ã‚’è¿”ã™
**A:** ä¾¡æ ¼ãƒ‡ãƒ¼ã‚¿ãŒä¸è¶³ã—ã¦ã„ã¾ã™ã€‚æœ€ä½30æ—¥åˆ†ã®ãƒ‡ãƒ¼ã‚¿ãŒå¿…è¦ã§ã™ã€‚

```typescript
// âŒ æ‚ªã„
correlation.updatePriceHistory('AAPL', [100, 101]);

// âœ… è‰¯ã„
correlation.updatePriceHistory('AAPL', thirtyDaysOfPrices);
```

### Q: Monte CarloãŒé…ã„
**A:** ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å›æ•°ã‚’æ¸›ã‚‰ã™ã‹ã€Web Workerã‚’ä½¿ç”¨ã—ã¦ãã ã•ã„ã€‚

```typescript
// é«˜é€Ÿ
const config = {
  numSimulations: 100,  // 1000ã§ã¯ãªã
  timeHorizon: 30,
  confidenceLevel: 0.95
};
```

### Q: ã‚¢ãƒ©ãƒ¼ãƒˆãŒå¤šã™ãã‚‹
**A:** é‡è¦åº¦ã§ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã—ã¦ãã ã•ã„ã€‚

```typescript
const alerts = psych.generatePsychologyAlerts();
const important = alerts.filter(a => 
  a.severity === 'high' || a.severity === 'medium'
);
```

## ğŸ¤ è²¢çŒ®

ã“ã®ã‚·ã‚¹ãƒ†ãƒ ã¯ç¶™ç¶šçš„ã«æ”¹å–„ã•ã‚Œã¦ã„ã¾ã™ã€‚ä»¥ä¸‹ã®ã‚ˆã†ãªè²¢çŒ®ã‚’æ­“è¿ã—ã¾ã™ï¼š

- ğŸ› ãƒã‚°å ±å‘Š
- âœ¨ æ–°æ©Ÿèƒ½ã®ææ¡ˆ
- ğŸ“ ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®æ”¹å–„
- ğŸ§ª ãƒ†ã‚¹ãƒˆã®è¿½åŠ 

## ğŸ“ ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã§ã™ã€‚

## ğŸ™ è¬è¾

- KellyåŸºæº–ã®å®Ÿè£…ã¯ Ed Thorp ã®ç ”ç©¶ã«åŸºã¥ã„ã¦ã„ã¾ã™
- Monte Carloã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã¯ Black-Scholes ãƒ¢ãƒ‡ãƒ«ã‚’å‚è€ƒã«ã—ã¦ã„ã¾ã™
- å¿ƒç†ç›£è¦–ã‚·ã‚¹ãƒ†ãƒ ã¯è¡Œå‹•ãƒ•ã‚¡ã‚¤ãƒŠãƒ³ã‚¹ã®ç ”ç©¶ã«åŸºã¥ã„ã¦ã„ã¾ã™

## ğŸ“ ã‚µãƒãƒ¼ãƒˆ

è³ªå•ã‚„ã‚µãƒãƒ¼ãƒˆãŒå¿…è¦ãªå ´åˆï¼š

1. [çµ±åˆã‚¬ã‚¤ãƒ‰](./docs/RISK_MANAGEMENT_INTEGRATION.md)ã‚’ç¢ºèª
2. ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã‚’å‚ç…§ï¼ˆ`__tests__/`ï¼‰
3. å‹å®šç¾©ã‚’ç¢ºèªï¼ˆ`app/types/risk.ts`ï¼‰

---

**Built with â¤ï¸ for safe and profitable trading**
