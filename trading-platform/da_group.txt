
FAIL app/__tests__/data-aggregator.test.ts
  ● Console
    console.error
      [2026-02-14T14:39:37.066Z] [ERROR]  Batch fetch failed: Error: AbortError: Aborted
      94 |     const formatted = this.formatMessage('error', message, context);
    > 96 |       console.error(formatted, error?.stack ?? error?.message ?? '');
      at Logger.error (app/core/logger.ts:96:15)
      at MarketDataClient.error [as fetchQuotes] (app/infrastructure/api/data-aggregator.ts:313:14)
    console.error
      [2026-02-14T14:39:37.104Z] [ERROR]  Batch fetch failed: Error: AbortError: Aborted
      94 |     const formatted = this.formatMessage('error', message, context);
    > 96 |       console.error(formatted, error?.stack ?? error?.message ?? '');
      at Logger.error (app/core/logger.ts:96:15)
      at MarketDataClient.error [as fetchQuotes] (app/infrastructure/api/data-aggregator.ts:313:14)
    console.error
      [2026-02-14T14:39:37.107Z] [ERROR]  Batch fetch failed: Error: AbortError: signal is aborted without reason
      94 |     const formatted = this.formatMessage('error', message, context);
    > 96 |       console.error(formatted, error?.stack ?? error?.message ?? '');
      at Logger.error (app/core/logger.ts:96:15)
      at MarketDataClient.error [as fetchQuotes] (app/infrastructure/api/data-aggregator.ts:313:14)
  ● MarketDataClient (Data Aggregator) Comprehensive Tests › handles batch fetchQuotes with chunking
FAIL app/lib/api/__tests__/DataAggregator.simple.test.ts (8.59 s)
  ● MarketDataClient Integration Tests › Basic Functionality › should handle empty data gracefully
      35 |       // The client returns a result object, but it might error out if data is empty or process it
      36 |       // Based on logs: {"data": null, "error": "No data available", "source": "idb", "success": false}
      38 |       expect(result.error).toBe('No data available');
FAIL app/lib/api/__tests__/DataAggregator.improved.test.ts (15.713 s)
  ● Console
      [2026-02-14T14:39:41.301Z] [WARN]  [Aggregator] Failed to update data for TEST, using stale data.
  ● Data Aggregator - Improved Data Fetching › Error Handling › should handle empty API response
      227 |       expect(result.error).toBeDefined();
Test Suites: 3 failed, 3 total
Tests:       3 failed, 38 passed, 41 total

