---
name: review-fix-pr
description: コードレビュー→修正→PR作成のワークフローを自動化。レビュー結果に基づく修正とPR作成を一貫して実行。
model: auto
---

# Review-Fix-PR スキル

コードレビューから修正、PR作成までの一連のワークフローを自動化します。

## 適用シナリオ

- レビュー後の修正対応
- テスト失敗の修正
- 軽微なバグ修正のPR化
- コード品質改善のPR作成

## ワークフロー

### 1. レビュー実施
```
- 対象コミット/ブランチ/PRの特定
- 完全な差分の取得（git show, git diff）
- 変更ファイルの全文読み込み
- 問題点の特定（バグ、セキュリティ、パフォーマンス）
```

### 2. 修正実行
```
- レビューで検出した問題の修正
- TypeScriptエラーの解消
- テストの修正・追加
- インポートパスの修正
- 浮動小数点比較の修正（toBe → toBeCloseTo）
```

### 3. 品質確認
```
- npm run test（テスト実行）
- npx tsc --noEmit（型チェック）
- npm run lint（リントチェック）
```

### 4. PR作成
```
- 新規ブランチの作成（fix/またはrefactor/プレフィックス）
- 変更のコミット（Conventional Commits準拠）
- リモートへのプッシュ
- PR作成（gh pr create）
  - タイトル: 日本語または英語（Conventional Commits形式）
  - 本文: 変更概要、詳細、確認項目
```

## コミットメッセージ規約

```
<type>: <subject>

<body>

<footer>
```

**Types:**
- `fix:` バグ修正
- `refactor:` リファクタリング
- `test:` テスト追加・修正
- `docs:` ドキュメント変更
- `chore:` その他の変更

## PR本文テンプレート

```markdown
## 概要
[変更の簡潔な説明]

## 変更内容
- [具体的な変更点1]
- [具体的な変更点2]

## 確認項目
- [x] テスト通過
- [x] TypeScriptコンパイル成功
- [x] リントチェック通過

## 関連
- [関連するIssue/PR/Commit]
```

## 自動アクション

以下は明示的な指示なく自動実行：

- ✅ テスト失敗時の自動修正提案
- ✅ インポートエラーの自動修正
- ✅ 型エラーの修正
- ✅ 浮動小数点比較の検出と修正

## 禁止事項

- ❌ mainブランチへの直接コミット
- ❌ 説明なしの空コミット
- ❌ 複数の無関係な変更を1つのPRにまとめる
- ❌ テストなしの機能変更

## 品質基準

レビュー時のチェック項目：

1. **バグ検出**
   - 論理エラー
   - 境界値の処理
   - エラーハンドリング

2. **セキュリティ**
   - 入力検証
   - 認証・認可
   - データ露出

3. **パフォーマンス**
   - O(N²)の検出
   - N+1クエリ
   - メモリリーク

4. **保守性**
   - コード重複
   - 過度なネスト
   - 命名規則

5. **テスト品質**
   - カバレッジ
   - アサーションの適切性
   - エッジケースの考慮
