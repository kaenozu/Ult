# ULT Backend - Python Analysis Engine

バックエンド分析エンジン。取引データ分析、需給分析、市場相関分析、取引ジャーナル分析を提供します。

## 概要

- **目的**: 取引データ分析ツールキット - 銘柄ユニバース管理、需給ゾーン検出、市場相関測定、取引ジャーナル分析
- **技術**: Python バックエンドモジュール + pytest テスト
- **特徴**: コアロジックに外部サービス不要

## ディレクトリ構造

```
backend/
├── src/
│   ├── market_correlation/    # 市場相関分析モジュール
│   ├── supply_demand/         # 需給分析モジュール
│   ├── trade_journal_analyzer/ # 取引ジャーナル分析モジュール
│   ├── ult_universe/          # 銘柄ユニバース管理モジュール
│   ├── utils/                 # ユーティリティ（performance_monitor等）
│   └── cache/                 # キャッシュ管理
├── tests/
│   └── ...                    # 単体テスト
└── FULL_CODE_REVIEW.md        # 包括的コードレビュー結果
```

## 主要モジュール

### 銘柄ユニバース管理 (`src/ult_universe/universe.py`)
- シンボルの追加/削除/一覧表示
- フォーマット検証
- JSON スナップショットの読み込み/保存
- デフォルトの米国/日本株ティッカーのシード

### 需給分析 (`src/supply_demand/`)
- 価格帯別ボリュームマップの構築
- サポート/レジスタンスゾーンの推定（強度スコア付き）
- ブレイクアウト検出
- 直近レベルの取得

### 市場相関 (`src/market_correlation/`)
- 相関係数とベータの計算（NumPy オプション）
- 回帰傾斜によるトレンド検出
- 市場トレンド + 個別シグナルの複合レコメンデーション

### 取引ジャーナル分析 (`src/trade_journal_analyzer/`)
- ジャーナルエントリの取り込み
- 勝率の計算
- ロスチェイシング/オーバートレーディングの検出
- 時間/シンボルパターンの抽出（キャッシング付き）
- シンボル別パフォーマンスのサマリー

### パフォーマンス・キャッシュユーティリティ
- `src/utils/performance_monitor.py`: タイミング、警告用のデコレータとヘルパー
- `src/cache/cache_manager.py`: メモ化、TTL キャッシュ（LRU eviction と統計付き）

## 使い方

### テストの実行

```bash
# テスト実行（外部データ不要、合成フィクスチャ使用）
pytest backend/tests
```

### 典型的な使用フロー

1. `StockUniverse` を構築
2. 価格-ボリュームペアから需給ゾーンを分析
3. 市場相関とトレンドを計算
4. 取引ジャーナルエントリを入力してパターンとバイアスアラートを抽出

## コントリビューター向けの注意

- Python のみ使用
- 型ヒントを使用し、小さな副作用のないヘルパーを好む
- テストは決定論的に保つ（現在のテストスイートはインメモリデータを使用、ネットワーク不要）
- `docs/` 内のプレーンテキストドキュメントと `skills/` 内の自動化スキル定義を維持

## 品質

- **テストカバレッジ**: 89%
- **テストケース**: 49個
- **評価**: 8.5/10

詳細は `FULL_CODE_REVIEW.md` を参照してください。
